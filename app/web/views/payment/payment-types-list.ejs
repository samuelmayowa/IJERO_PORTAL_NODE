<!-- app/web/views/payment/payment-types-list.ejs -->
<section class="content">
  <div class="container-fluid">
    <h4 class="mb-3">Payment Types</h4>

    <% if (messages && messages.error) { %>
      <div class="alert alert-danger"><i class="fas fa-exclamation-triangle mr-1"></i><%= messages.error %></div>
    <% } %>
    <% if (messages && messages.success) { %>
      <div class="alert alert-success"><i class="fas fa-check mr-1"></i><%= messages.success %></div>
    <% } %>

    <div class="d-flex justify-content-between mb-2">
      <form class="form-inline" method="GET" action="/staff/fees/payment-types">
        <input class="form-control mr-2" name="q" value="<%= q || '' %>" placeholder="Search name/purpose">
        <button class="btn btn-outline-secondary">Search</button>
      </form>
      <a class="btn btn-primary" href="/staff/fees/payment-types/add"><i class="fas fa-plus mr-1"></i>Add Payment Type</a>
    </div>

    <div class="card card-primary">
      <div class="card-body p-0">
        <table class="table table-striped table-bordered mb-0">
          <thead>
            <tr>
              <th style="width:60px">ID</th>
              <th>Name</th>
              <th>Purpose</th>
              <th style="width:110px">Amount (₦)</th>
              <th style="width:110px">Portal (₦)</th>
              <th style="width:120px">Scope</th>
              <th style="width:100px">Active</th>
              <th style="width:120px"></th>
            </tr>
          </thead>
          <tbody>
            <% if (!rows || !rows.length) { %>
              <tr><td colspan="8" class="text-center text-muted">No records</td></tr>
            <% } else { rows.forEach(r => { %>
              <tr>
                <td><%= r.id %></td>
                <td><%= r.name %></td>
                <td><%= r.purpose %></td>
                <td><%= r.amount %></td>
                <td><%= r.portal_charge %></td>
                <td><%= r.scope %></td>
                <td><%= r.is_active ? 'Yes' : 'No' %></td>
                <td class="text-right">
                  <a class="btn btn-sm btn-outline-primary" href="/staff/fees/payment-types/<%= r.id %>/edit">Edit</a>
                </td>
              </tr>
            <% }) } %>
          </tbody>
        </table>
      </div>

      <div class="card-footer d-flex justify-content-between">
        <div class="text-muted small">Page <%= (pagination && pagination.page) || 1 %> of <%= (pagination && pagination.totalPages) || 1 %></div>
        <div>
          <% const cur = (pagination && pagination.page) || 1; const last = (pagination && pagination.totalPages) || 1; %>
          <a class="btn btn-sm btn-outline-secondary <%= cur<=1?'disabled':'' %>" href="?q=<%= encodeURIComponent(q||'') %>&page=<%= Math.max(1, cur-1) %>">Prev</a>
          <% for (let p=1; p<=last; p++) { %>
            <a class="btn btn-sm <%= p===cur ? 'btn-primary':'btn-outline-primary' %>" href="?q=<%= encodeURIComponent(q||'') %>&page=<%= p %>"><%= p %></a>
          <% } %>
          <a class="btn btn-sm btn-outline-secondary <%= cur>=last?'disabled':'' %>" href="?q=<%= encodeURIComponent(q||'') %>&page=<%= Math.min(last, cur+1) %>">Next</a>
        </div>
      </div>
    </div>
  </div>
</section>
