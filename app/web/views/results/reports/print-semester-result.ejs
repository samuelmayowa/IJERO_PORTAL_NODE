<!doctype html>
<html>
<head>
  <meta charset="utf-8" />
  <title>Semester Result</title>
  <style>
    body { font-family: "Times New Roman", serif; color:#000; margin: 10mm; }
    .center { text-align:center; }
    .small { font-size: 12px; }
    .tiny { font-size: 11px; }
    .bold { font-weight: 700; }
    table { border-collapse: collapse; width: 100%; }
    th, td { border: 1px solid #000; padding: 3px 4px; vertical-align: middle; }
    th { font-weight: 700; }
    .no-border, .no-border td, .no-border th { border: none; }
    .mt-10 { margin-top: 10px; }
    .mt-20 { margin-top: 20px; }

    .footer {
      position: fixed;
      left: 10mm;
      right: 10mm;
      bottom: 8mm;
      display: flex;
      justify-content: space-between;
      font-size: 12px;
    }

    @media print {
      .footer { position: fixed; }
    }
  </style>
</head>
<body>

<% if (meta?.message && (!sheet || !sheet.detailRows || !sheet.detailRows.length)) { %>
  <div class="center bold"><%= meta.message %></div>
  <div class="footer">
    <div>
      <% if (String(meta.statusMode || '').toLowerCase() === 'approved' && meta.batchLabel) { %>
        Approved Version: Batch <%= meta.batchLabel %>
      <% } %>
    </div>
    <div>Page- 1/1</div>
    <div>Printed @ <%= meta.printedAt || '' %></div>
  </div>
</body>
</html>
<% return; } %>

<div class="center bold"><%= meta.institutionName || "" %></div>
<div class="center bold small"><%= (meta.schoolName || "").toUpperCase() %></div>
<div class="center bold small"><%= (meta.departmentName || "").toUpperCase() %></div>
<% if (meta.programmeName) { %>
  <div class="center bold small"><%= (meta.programmeName || "").toUpperCase() %></div>
<% } %>
<div class="center bold small"><%= meta.semesterLabel || "" %> RESULT, <%= meta.sessionName || "" %> ACADEMIC SESSION</div>
<div class="center bold small"><%= meta.levelLabel || "" %></div>

<table class="mt-10">
  <tr>
    <td style="width:32%; vertical-align:top;">
      <div class="bold small">CLASSIFICATION OF GRADE</div>
      <table class="tiny" style="width:100%; margin-top:4px;">
        <tr><td>3.50 - 4.00</td><td>Distinction</td></tr>
        <tr><td>3.00 - 3.49</td><td>Upper Credit</td></tr>
        <tr><td>2.50 - 2.99</td><td>Lower Credit</td></tr>
        <tr><td>1.50 - 2.49</td><td>Pass</td></tr>
        <tr><td>0.00 - 1.49</td><td>Fail</td></tr>
      </table>
    </td>
    <td style="width:68%;"></td>
  </tr>
</table>

<table class="mt-10 tiny">
  <thead>
    <tr>
      <th rowspan="2" style="width:40px;">S/N</th>
      <th rowspan="2" style="width:120px;">MATRIC NO</th>
      <th rowspan="2">NAME</th>

      <th colspan="<%= (sheet.courses || []).length %>">CURRENT SEMESTER/COURSE CODES/UNITS</th>

      <th colspan="4">CURRENT</th>
      <th colspan="4">PREVIOUS</th>
      <th colspan="4">CUMMULATIVE</th>

      <th rowspan="2" style="width:130px;">CARRY OVER</th>
      <th rowspan="2" style="width:90px;">PASS/REPEAT</th>
      <th rowspan="2" style="width:130px;">OUTSTANDING</th>
    </tr>
    <tr>
      <% (sheet.courses || []).forEach(c => { %>
        <th class="center"><%= c.code %><br/><span class="tiny"><%= c.units %></span></th>
      <% }) %>

      <th class="center">TCP</th>
      <th class="center">TLU</th>
      <th class="center">TUP</th>
      <th class="center">GPA</th>

      <th class="center">TCP</th>
      <th class="center">TLU</th>
      <th class="center">TUP</th>
      <th class="center">GPA</th>

      <th class="center">TCP</th>
      <th class="center">TLU</th>
      <th class="center">TUP</th>
      <th class="center">GPA</th>
    </tr>
  </thead>

  <tbody>
    <% (sheet.detailRows || []).forEach(r => { %>
      <tr>
        <td class="center"><%= r.sn %></td>
        <td><%= r.matric %></td>
        <td><%= r.full_name %></td>

        <% (r.grades || []).forEach(g => { %>
          <td class="center"><%= g %></td>
        <% }) %>

        <td class="center"><%= r.current?.tcp ?? 0 %></td>
        <td class="center"><%= r.current?.tlu ?? 0 %></td>
        <td class="center"><%= r.current?.tup ?? 0 %></td>
        <td class="center"><%= r.current?.gpa ?? 0 %></td>

        <td class="center"><%= r.previous?.tcp ?? 0 %></td>
        <td class="center"><%= r.previous?.tlu ?? 0 %></td>
        <td class="center"><%= r.previous?.tup ?? 0 %></td>
        <td class="center"><%= r.previous?.gpa ?? 0 %></td>

        <td class="center"><%= r.cumulative?.tcp ?? 0 %></td>
        <td class="center"><%= r.cumulative?.tlu ?? 0 %></td>
        <td class="center"><%= r.cumulative?.tup ?? 0 %></td>
        <td class="center"><%= r.cumulative?.gpa ?? 0 %></td>

        <td><%= (r.carryOver || []).join(", ") %></td>
        <td class="center"><%= r.passRepeat || "" %></td>
        <td><%= (r.outstanding || []).join(", ") %></td>
      </tr>
    <% }) %>
  </tbody>
</table>

<table class="mt-10">
  <tr>
    <td style="width:33%; vertical-align:top;">
      <table class="tiny" style="width:100%;">
        <tr><th colspan="4" class="center">COURSE TITTLE &nbsp;&nbsp; CODES &nbsp;&nbsp; UNITS</th></tr>
        <tr>
          <th style="width:40px;">S/N</th>
          <th>COURSE TITLE</th>
          <th style="width:80px;">CODES</th>
          <th style="width:60px;">UNITS</th>
        </tr>
        <% (sheet.courses || []).forEach((c, idx) => { %>
          <tr>
            <td class="center"><%= idx+1 %></td>
            <td><%= c.title %></td>
            <td class="center"><%= c.code %></td>
            <td class="center"><%= c.units %></td>
          </tr>
        <% }) %>
        <tr>
          <th colspan="3" class="center">TOTAL UNITS</th>
          <th class="center"><%= sheet.totalUnits ?? "" %></th>
        </tr>
      </table>
    </td>

    <td style="width:33%; vertical-align:top;">
      <table class="tiny" style="width:100%;">
        <tr><th colspan="2" class="center">SUMMARY OF RESULTS</th></tr>
        <tr><td>No. OF EXAMINED</td><td class="center"><%= sheet.summary?.examined ?? 0 %></td></tr>
        <tr><td>No. DISTINCTION</td><td class="center"><%= sheet.summary?.distinction ?? 0 %></td></tr>
        <tr><td>No. UPPER CREDIT</td><td class="center"><%= sheet.summary?.upper ?? 0 %></td></tr>
        <tr><td>No. OF LOWER CREDIT</td><td class="center"><%= sheet.summary?.lower ?? 0 %></td></tr>
        <tr><td>No. OF PASSES</td><td class="center"><%= sheet.summary?.pass ?? 0 %></td></tr>
        <tr><td>No. OF FAIL</td><td class="center"><%= sheet.summary?.fail ?? 0 %></td></tr>
        <tr><th>TOTAL</th><th class="center"><%= sheet.summary?.total ?? 0 %></th></tr>
      </table>
    </td>

    <td style="width:34%; vertical-align:top;">
      <table class="tiny" style="width:100%;">
        <tr><th colspan="3" class="center">GRADE INTERPRETATION</th></tr>
        <tr><th>SCORE</th><th>GRADE</th><th>POINT</th></tr>
        <tr><td>70 - 100</td><td class="center">A</td><td class="center">4</td></tr>
        <tr><td>65 - 69</td><td class="center">B</td><td class="center">3.5</td></tr>
        <tr><td>60 - 64</td><td class="center">C</td><td class="center">3</td></tr>
        <tr><td>55 - 59</td><td class="center">D</td><td class="center">2.5</td></tr>
        <tr><td>50 - 54</td><td class="center">E</td><td class="center">2</td></tr>
        <tr><td>0 - 49</td><td class="center">F</td><td class="center">0</td></tr>
      </table>
    </td>
  </tr>
</table>

<table class="no-border mt-20 tiny" style="width:100%;">
  <tr class="no-border">
    <td class="no-border center">_________________________<br/>H.O.D</td>
    <td class="no-border center">_________________________<br/>DEAN</td>
    <td class="no-border center">_________________________<br/>REGISTRAR</td>
    <td class="no-border center">_________________________<br/>PROVOST</td>
  </tr>
</table>

<div class="footer">
  <div>
    <% if (String(meta.statusMode || '').toLowerCase() === 'approved' && meta.batchLabel) { %>
      Approved Version: Batch <%= meta.batchLabel %>
    <% } %>
  </div>
  <div>Page- 1/1</div>
  <div>Printed @ <%= meta.printedAt || '' %></div>
</div>

</body>
</html>
